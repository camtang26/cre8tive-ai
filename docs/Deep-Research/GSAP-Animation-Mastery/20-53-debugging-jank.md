### 5.3 Debugging Jank

If an animation isn't smooth, use DevTools: - **Performance profile**: Look for spikes. If Scripting is high, it's likely too many operations in JS (maybe too many elements animating or heavy logic). If Rendering/Painting is high, maybe large DOM repaints (big images, lots of text reflow). - If scripting, consider simplifying logic or reducing number of simultaneous tweens. GSAP can animate thousands of elements, but not all at once visible on screen -- consider staggering or only animating what's in viewport. - If painting, check element sizes. A huge fullscreen element with a blur filter animating will be costly each frame to repaint. Perhaps reduce blur intensity or find another way (use an pre-blurred image instead of dynamic blur). - **GSAP dev tools:** There is `GSAP.context().add()` which can log when animations start/stop, and the GSAP timeline can be visualized if you include GSDevTools (for debugging timing). - **Will-change pitfalls:** If using will-change transform on an element that constantly changes size, it could cause continuous reallocation. Remove will-change once done: GSAP's context revert can remove it, or you manually unset after animation if persistent. Some devs do: `onComplete: () => element.style.willChange = 'auto'` to remove hint after using it. - **Images and decoding:** Large images being loaded can cause jank. If an animation triggers image loads (like moving to a section with new images), those images might decode on the fly. Use `decode()` on images before animating if possible (modern browsers allow image.decode() to preload decode). Or ensure images are loaded (maybe via lazy loading strategies) before heavy animations start. - **Third-party interference:** Sometimes other scripts (like a DOM library or analytics) might hog the main thread intermittently. If you suspect, try disabling them to see if animations improve. If yes, consider scheduling heavy animations away from such events or optimizing those scripts.
