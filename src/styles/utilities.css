@layer utilities {
  .glass-morphism {
    @apply backdrop-blur-xl bg-white/5 border border-white/10;
  }
  
  .text-gradient {
    @apply bg-gradient-to-br from-white via-white/90 to-white/70 bg-clip-text text-transparent;
    text-shadow: 0 0 10px rgba(255,255,255,0.15),
                 0 0 20px rgba(255,255,255,0.1);
  }

  .animate-fade-in {
    animation: fadeIn 0.6s ease-out forwards;
  }

  .animate-scale-in {
    animation: scaleIn 0.3s ease-out forwards;
  }

  .hover-lift {
    @apply transition-transform duration-300 hover:-translate-y-2;
  }

  .hover-glow {
    @apply transition-all duration-300 hover:shadow-2xl;
  }

  .neon-glow {
    text-shadow: 0 0 10px rgba(255,255,255,0.8),
                 0 0 20px rgba(255,255,255,0.4),
                 0 0 30px rgba(255,255,255,0.2);
  }

  .neon-glow-subtle {
    text-shadow: 0 0 5px rgba(255,255,255,0.4),
                 0 0 10px rgba(255,255,255,0.2);
  }

  .perspective-1000 {
    perspective: 1000px;
  }

  .rotate-y-10 {
    transform: rotateY(10deg);
  }

  /* STORY 1.14: Enhanced GPU-optimized transform class */
  .transform-gpu {
    transform: translate3d(0, 0, 0) translateZ(0);
    backface-visibility: hidden;
    transform-style: preserve-3d;
  }

  /* STORY 1.14: Animated element optimization (will-change + containment) */
  .animated-element {
    will-change: transform, opacity;
    contain: layout style paint;
  }

  /* Alias for consistency (gpu-optimized = transform-gpu) */
  .gpu-optimized {
    transform: translateZ(0);
    backface-visibility: hidden;
  }

  [animation-delay="200ms"] {
    animation-delay: 200ms;
  }

  [animation-delay="400ms"] {
    animation-delay: 400ms;
  }

  [animation-delay="600ms"] {
    animation-delay: 600ms;
  }

  .fade-in-visible {
    @apply opacity-100 translate-y-0;
  }

  /* STORY 1.14: Lazy loading optimization (content-visibility) */
  .lazy-section {
    content-visibility: auto;
    contain-intrinsic-size: 0 500px;
  }

  /* STORY 1.14: Enhanced prefers-reduced-motion support (WCAG 2.1 compliance) */
  @media (prefers-reduced-motion: reduce) {
    .fade-in-visible {
      @apply transition-none transform-none;
    }

    /* Force instant transitions globally for accessibility */
    * {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
      scroll-behavior: auto !important;
    }

    /* Disable GSAP animations (handled by adaptive-config.ts) */
    [data-gsap-animation] {
      animation: none !important;
      transition: none !important;
    }
  }

  /* Premium hero-specific utilities */
  .studios-hero-particles {
    position: absolute;
    inset: 0;
    background-image:
      radial-gradient(220px 220px at 15% 30%, rgba(49, 196, 255, 0.28) 0%, rgba(49, 196, 255, 0) 70%),
      radial-gradient(320px 320px at 70% 20%, rgba(225, 179, 65, 0.22) 0%, rgba(225, 179, 65, 0) 75%),
      radial-gradient(180px 180px at 82% 70%, rgba(142, 220, 255, 0.32) 0%, rgba(142, 220, 255, 0) 65%),
      radial-gradient(260px 260px at 40% 85%, rgba(20, 36, 68, 0.55) 0%, rgba(20, 36, 68, 0) 80%);
    mix-blend-mode: screen;
    opacity: 0.45;
    animation: studiosParticleDrift 18s ease-in-out infinite;
  }

  .studios-hero-noise {
    position: absolute;
    inset: 0;
    opacity: 0.12;
    pointer-events: none;
    background-image: var(--tw-gradient-studios-noise, url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 400 400'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='1.4' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.85'/%3E%3C/svg%3E"));
    animation: studiosNoisePulse 14s steps(8) infinite;
  }

  .hero-curve-mask {
    position: relative;
    isolation: isolate;
  }

  .hero-curve-mask::before {
    content: "";
    position: absolute;
    inset: -25% -30% -20% -20%;
    background: radial-gradient(120% 120% at 10% 50%, rgba(5, 6, 13, 0) 0%, rgba(5, 6, 13, 0.55) 52%, rgba(5, 6, 13, 0.92) 92%);
    mix-blend-mode: multiply;
    pointer-events: none;
    z-index: -1;
  }

  @keyframes studiosParticleDrift {
    0% {
      background-position: 0% 0%, 30% 20%, 80% 70%, 10% 80%;
    }
    50% {
      background-position: 4% 6%, 35% 12%, 75% 68%, 16% 75%;
    }
    100% {
      background-position: 0% 0%, 30% 20%, 80% 70%, 10% 80%;
    }
  }

  @keyframes studiosNoisePulse {
    0%, 100% {
      opacity: 0.12;
    }
    50% {
      opacity: 0.2;
    }
  }

  .headline-premium {
    position: relative;
    display: inline-block;
    color: #f6f8ff;
    text-shadow: 0 16px 40px rgba(14, 28, 50, 0.45), 0 0 48px rgba(49, 196, 255, 0.28), 0 0 72px rgba(225, 179, 65, 0.24);
  }

  .headline-premium::before {
    content: "";
    position: absolute;
    inset: 0;
    background: repeating-linear-gradient(0deg, rgba(255, 255, 255, 0.12) 0px, rgba(255, 255, 255, 0.12) 1px, transparent 3px, transparent 6px);
    opacity: 0.18;
    mix-blend-mode: screen;
    pointer-events: none;
    animation: heroHeadlineScan 28s linear infinite;
  }

  .headline-premium::after {
    content: "";
    position: absolute;
    inset: 0;
    background: linear-gradient(120deg, rgba(255, 255, 255, 0) 0%, rgba(255, 255, 255, 0.7) 45%, rgba(255, 255, 255, 0) 75%);
    mix-blend-mode: screen;
    filter: blur(2px);
    opacity: 0.6;
    pointer-events: none;
    transform: translateX(-120%);
    animation: heroHeadlineSheen 16s cubic-bezier(0.25, 0.1, 0.25, 1) infinite;
  }

  @keyframes heroHeadlineSheen {
    0%, 40% {
      transform: translateX(-120%);
      opacity: 0;
    }
    45%, 55% {
      opacity: 0.7;
    }
    60%, 100% {
      transform: translateX(120%);
      opacity: 0;
    }
  }

  @keyframes heroHeadlineScan {
    0% {
      background-position: 0% 100%;
    }
    50% {
      background-position: 0% 0%;
    }
    100% {
      background-position: 0% 100%;
    }
  }

  .cta-magnetic {
    --cta-offset-x: 0px;
    --cta-offset-y: 0px;
    --cta-scale: 1;
    --cta-arrow-offset-x: 0px;
    --cta-arrow-offset-y: 0px;
    --cta-arrow-rotate: 0deg;
    transform: translate3d(var(--cta-offset-x), var(--cta-offset-y), 0) scale(var(--cta-scale));
    transition: transform 180ms cubic-bezier(0.16, 1, 0.3, 1), text-shadow 220ms ease, box-shadow 220ms ease;
  }

  .cta-magnetic:hover {
    text-shadow: 0 0 18px rgba(225, 179, 65, 0.6), 0 0 36px rgba(49, 196, 255, 0.5);
  }

  .cta-magnetic:focus-visible {
    --cta-scale: 1.04;
    box-shadow: 0 0 0 2px rgba(7, 9, 18, 0.9), 0 0 0 4px rgba(49, 196, 255, 0.55);
  }

  .cta-magnetic[data-reduced-motion="true"] {
    transform: none !important;
    text-shadow: none !important;
  }

  .cta-arrow {
    transition: transform 180ms cubic-bezier(0.16, 1, 0.3, 1), background 200ms ease;
    transform: translate3d(var(--cta-arrow-offset-x, 0px), var(--cta-arrow-offset-y, 0px), 0) rotate(var(--cta-arrow-rotate, 0deg));
  }

  .cta-secondary-trail {
    --trail-offset-x: 0px;
    --trail-offset-y: 0px;
    transform: translate3d(var(--trail-offset-x), var(--trail-offset-y), 0);
    transition: transform 190ms cubic-bezier(0.16, 1, 0.3, 1), border-color 220ms ease, color 220ms ease;
  }

  .cta-secondary-trail:focus-visible {
    box-shadow: 0 0 0 2px rgba(7, 9, 18, 0.85), 0 0 0 4px rgba(49, 196, 255, 0.4);
  }

  .cta-secondary-trail[data-reduced-motion="true"] {
    transform: none !important;
  }

  .cta-trail-dot {
    transition: transform 220ms cubic-bezier(0.16, 1, 0.3, 1), background 220ms ease;
    transform: translate3d(calc(var(--trail-offset-x, 0px) * 0.25), calc(var(--trail-offset-y, 0px) * 0.25), 0);
    box-shadow: 0 0 18px rgba(49, 196, 255, 0.45);
  }

  .hero-pointer-highlight {
    width: 100%;
    height: 100%;
    background: radial-gradient(340px circle at var(--pointer-x, 50%) var(--pointer-y, 50%), rgba(49, 196, 255, 0.24), rgba(225, 179, 65, 0.14) 40%, transparent 75%);
    opacity: 0.32;
    transition: opacity 420ms ease;
  }

  .hero-pointer-highlight[data-active="false"] {
    opacity: 0.18;
  }

  .hero-pointer-highlight[data-active="true"] {
    opacity: 0.56;
  }

  .timeline-overlay {
    opacity: 0;
    transition: opacity 300ms ease;
  }

  .timeline-overlay[data-active="true"] {
    opacity: 1;
  }

  .timeline-marker {
    position: relative;
    height: 12px;
    width: 12px;
    border-radius: 9999px;
    background: rgba(255, 255, 255, 0.28);
    transition: background 200ms ease, transform 200ms ease, box-shadow 200ms ease;
  }

  .timeline-marker::after {
    content: attr(data-label);
    position: absolute;
    bottom: 140%;
    left: 50%;
    transform: translate(-50%, 8px);
    padding: 6px 10px;
    border-radius: 9999px;
    background: rgba(7, 12, 22, 0.9);
    color: rgba(246, 248, 255, 0.92);
    font-size: 11px;
    letter-spacing: 0.18em;
    text-transform: uppercase;
    opacity: 0;
    pointer-events: none;
    transition: opacity 160ms ease, transform 160ms ease;
    box-shadow: 0 8px 24px -12px rgba(0, 0, 0, 0.6);
  }

  .timeline-marker:hover,
  .timeline-marker:focus-visible {
    background: rgba(49, 196, 255, 0.9);
    transform: scale(1.15);
    box-shadow: 0 0 28px rgba(49, 196, 255, 0.45);
  }

  .timeline-marker:hover::after,
  .timeline-marker:focus-visible::after {
    opacity: 1;
    transform: translate(-50%, -4px);
  }

  .timeline-marker:focus-visible {
    outline: none;
  }

  @media (prefers-reduced-motion: reduce) {
    .headline-premium::before,
    .headline-premium::after {
      animation: none;
      opacity: 0.15;
    }

    .timeline-overlay {
      transition-duration: 0ms;
    }

    .timeline-marker::after {
      transition-duration: 0ms;
    }
  }
}
